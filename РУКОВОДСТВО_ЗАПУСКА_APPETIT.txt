APPETIT MVP — Руководство по запуску (Windows/PowerShell)

1) Требования
   - Node.js LTS (18/20)
   - pnpm:  npm i -g pnpm
   - Docker Desktop (запущен)
   - API‑ключ Яндекс.Карт (для отображения карты)

2) Распаковка
   - Распакуйте архив в удобную папку, далее все команды из папки проекта (корень архива).

3) Настройка .env
   - Скопируйте .env.example в .env (UTF-8):
     PowerShell:
       Get-Content .env.example | Set-Content -Encoding UTF8 .env

   - Проверьте и при необходимости измените переменные:
       DATABASE_URL=postgresql://postgres:postgres@localhost:5432/appetit
       API_PORT=3001
       NEXT_PUBLIC_API_BASE=http://localhost:3001/api/v1
       NEXT_PUBLIC_YANDEX_MAPS_API_KEY=<ваш ключ>
       JWT_SECRET=dev-secret
     (для prisma CLI можно скопировать DATABASE_URL в apps/api/prisma/.env)

4) Поднять Postgres в Docker
   docker compose up -d

5) Установка зависимостей
   pnpm i
   pnpm api:generate

6) Инициализация БД
   pnpm api:db:push
   pnpm api:db:seed

7) Запуск приложений
   Вариант A — вручную в двух окнах:
     pnpm -C apps/api dev    # API: http://localhost:3001/api/v1/health
     pnpm -C apps/web dev    # Web: http://localhost:3000
   Вариант B — скрипт запуска (Windows PowerShell):
     .\start-dev.ps1         # поднимает DB, API и Web

8) Полезные эндпоинты (BASE = http://localhost:3001/api/v1)
   - GET /health
   - GET /categories
   - GET /dishes[?q=][&categoryId=][&branchId=]
   - GET /dishes/:id
   - GET /dishes/search?q=
   - GET /zones
   - GET /branches
   - GET /cms/delivery-terms
   - POST /orders (см. apps/api/src/index.ts для формата)
   - POST /auth/request-code
   - POST /auth/verify-code
   - POST /auth/register-email
   - POST /admin/register
   - POST /admin/login

9) Архитектура
   - Монорепо pnpm workspaces:
       apps/api — backend (Express + Prisma + PostgreSQL)
       apps/web — frontend (Next.js pages)
       packages/shared — общие типы/утилиты (DTO)

   - Независимая работа:
       API и Web запускаются отдельными скриптами:
         pnpm -C apps/api dev
         pnpm -C apps/web dev

10) Частые проблемы
   - P1012 (нет DATABASE_URL): проверьте .env и apps/api/prisma/.env
   - P1000 (неверные креды): docker-compose.yml задаёт postgres/postgres
   - NEXT_PUBLIC_YANDEX_MAPS_API_KEY не задан: карта не отображается
   - UTF-16 .env: переконвертируйте в UTF-8:
       Get-Content .env | Set-Content -Encoding UTF8 .env

11) Дальше по ТЗ
   - Добавить CRUD админки (меню/заказы), промокоды/баннеры, аналитика.
   - Подготовить API для мобилки (тот же REST).

Удачи!
